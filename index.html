<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Convert Pro | Fast & Free</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background: #f3f4f6; }
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .gradient-text {
            background: linear-gradient(90deg, #4f46e5, #ec4899);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        /* Loading Spinner Style */
        .spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 3px solid #fff;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 10px;
            vertical-align: middle;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <nav class="p-6 bg-white shadow-sm flex justify-between items-center px-10">
        <h1 class="text-2xl font-bold gradient-text">PDF Convert Pro</h1>
        <div class="space-x-6 hidden md:block">
            <a href="#" class="hover:text-indigo-600 transition">How it works</a>
            <a href="#" class="hover:text-indigo-600 transition">Privacy</a>
            <a href="#" class="bg-indigo-600 text-white px-5 py-2 rounded-full shadow-lg">Free Trial</a>
        </div>
    </nav>

    <main class="flex-grow container mx-auto px-4 py-12 text-center">
        <div class="max-w-4xl mx-auto h-24 bg-gray-200 mb-8 flex items-center justify-center border border-dashed border-gray-400 text-gray-500 rounded">
            Google AdSense Auto-Ad Space
        </div>

        <h2 class="text-5xl font-extrabold text-gray-800 mb-4">Convert PDF to Word <span class="gradient-text">Instantly.</span></h2>
        <p class="text-gray-600 text-lg mb-10">High-quality conversion powered by AI. No registration required.</p>

        <div class="max-w-2xl mx-auto glass-card p-10 rounded-3xl shadow-2xl transition-all hover:shadow-indigo-100">
            <div id="drop-zone" class="border-4 border-dashed border-indigo-200 rounded-2xl p-12 hover:border-indigo-500 transition-colors cursor-pointer group">
                <div class="flex flex-col items-center">
                    <svg class="w-16 h-16 text-indigo-500 mb-4 group-hover:scale-110 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                    </svg>
                    <p id="file-name" class="text-xl font-medium text-gray-700">Choose PDF File</p>
                    <p class="text-gray-400 mt-2">or drag and drop here</p>
                </div>
                <input type="file" id="file-input" class="hidden" accept=".pdf">
            </div>

            <button id="convert-btn" onclick="uploadFile()" class="mt-8 w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 rounded-xl shadow-xl transform active:scale-95 transition flex items-center justify-center">
                <span id="btn-text">Convert to Word (.docx)</span>
            </button>
            
            <p id="status-msg" class="mt-4 text-sm font-medium"></p>
        </div>

        <div class="max-w-4xl mx-auto h-24 bg-gray-200 mt-12 flex items-center justify-center border border-dashed border-gray-400 text-gray-500 rounded">
            Google AdSense Bottom Ad
        </div>
    </main>

    <footer class="bg-gray-900 text-white py-10 mt-20 text-center">
        <p>&copy; 2026 PDF Convert Pro - The World's Best PDF Tools.</p>
    </footer>

    <script>
        const dropZone = document.getElementById('drop-zone');
        const fileInput = document.getElementById('file-input');
        const fileNameDisplay = document.getElementById('file-name');
        const convertBtn = document.getElementById('convert-btn');
        const btnText = document.getElementById('btn-text');
        const statusMsg = document.getElementById('status-msg');

        // File select event
        dropZone.onclick = () => fileInput.click();

        fileInput.onchange = () => {
            if (fileInput.files.length > 0) {
                fileNameDisplay.innerText = fileInput.files[0].name;
                fileNameDisplay.classList.add('text-indigo-600');
                statusMsg.innerText = "";
            }
        };

        async function uploadFile() {
            if(fileInput.files.length === 0) {
                alert("Please select a PDF file first.");
                return;
            }

            const file = fileInput.files[0];
            const formData = new FormData();
            formData.append('file', file);

            // UI Update: Loading state
            convertBtn.disabled = true;
            convertBtn.classList.add('opacity-75', 'cursor-not-allowed');
            btnText.innerHTML = '<span class="spinner"></span> Converting...';
            statusMsg.innerText = "Processing your PDF, please wait a moment.";
            statusMsg.className = "mt-4 text-sm font-medium text-indigo-600";

            try {
                // Flask Backend URL (CORS handle kara nisa meka weda)
                const response = await fetch('http://127.0.0.1:5000/convert', {
                    method: 'POST',
                    body: formData
                });

                if (response.ok) {
                    const blob = await response.blob();
                    const downloadUrl = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = downloadUrl;
                    
                    // Original name ekata .docx set kirima
                    const originalName = file.name.split('.').slice(0, -1).join('.');
                    a.download = `${originalName}.docx`;
                    
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);

                    statusMsg.innerText = "✅ Conversion Successful! Your file is downloading.";
                    statusMsg.className = "mt-4 text-sm font-medium text-green-600";
                } else {
                    const errorData = await response.json();
                    statusMsg.innerText = "❌ Error: " + (errorData.error || "Conversion failed.");
                    statusMsg.className = "mt-4 text-sm font-medium text-red-600";
                }
            } catch (error) {
                console.error("Fetch Error:", error);
                statusMsg.innerText = "❌ Cannot connect to Backend. Make sure app.py is running.";
                statusMsg.className = "mt-4 text-sm font-medium text-red-600";
            } finally {
                // UI Update: Reset state
                convertBtn.disabled = false;
                convertBtn.classList.remove('opacity-75', 'cursor-not-allowed');
                btnText.innerText = "Convert to Word (.docx)";
            }
        }

        // Drag and Drop Support
        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('border-indigo-500', 'bg-indigo-50');
        });

        dropZone.addEventListener('dragleave', () => {
            dropZone.classList.remove('border-indigo-500', 'bg-indigo-50');
        });

        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('border-indigo-500', 'bg-indigo-50');
            if (e.dataTransfer.files.length > 0) {
                fileInput.files = e.dataTransfer.files;
                fileNameDisplay.innerText = fileInput.files[0].name;
            }
        });
    </script>
</body>
</html>